<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>

<!--Article Number is __________ (fill in blank)-->

<!--Use this template for articles that explain or describe something (such as an operating system). For articles that include steps for accomplishing a task (for example, installing), use the Informational template instead.  -->

<title>17506 - Configure Two-factor SSH Authentication with Authy - CentOS, Fedora</title>
<style type="text/css">
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }

p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}

.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
</style>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:ArticleKeywords msdt:dt="string">SSH, Security</mso:ArticleKeywords>
<mso:Reference msdt:dt="string">https://www.digitalocean.com/community/tutorials/how-to-install-authy-and-configure-two-factor-authentication-for-ssh, https://www.digitalocean.com/community/tutorials/how-to-install-authy-and-configure-two-factor-authentication-for-ssh</mso:Reference>
<mso:LinuxDistributions msdt:dt="string">;#CentOS;#Fedora;#</mso:LinuxDistributions>
<mso:ArticlePriority msdt:dt="string">1</mso:ArticlePriority>
<mso:RequestNotes msdt:dt="string">Prereqs - None, but lead off by having reader download Authy app on Android/iOS device.</mso:RequestNotes>
<mso:Difficulty msdt:dt="string">1</mso:Difficulty>
<mso:ForkSplit msdt:dt="string"></mso:ForkSplit>
<mso:ArticleID msdt:dt="string">17506</mso:ArticleID>
<mso:UnsupportedFeatures msdt:dt="string"></mso:UnsupportedFeatures>
<mso:Collapsed msdt:dt="string"></mso:Collapsed>
<mso:Complexity msdt:dt="string"></mso:Complexity>
<mso:Week msdt:dt="string">3.00000000000000</mso:Week>
<mso:ArticleStatus msdt:dt="string">Not started</mso:ArticleStatus>
<mso:HoursDraftingEstimated msdt:dt="string">0.300000000000000</mso:HoursDraftingEstimated>
<mso:HoursEditingEstimated msdt:dt="string">0.100000000000000</mso:HoursEditingEstimated>
<mso:Sample msdt:dt="string">z</mso:Sample>
<mso:DeliveryTarget msdt:dt="string"></mso:DeliveryTarget>
<mso:EditScore msdt:dt="string"></mso:EditScore>
<mso:PrereqOrdering msdt:dt="string">2</mso:PrereqOrdering>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>

<body>
<h1>Configure Two-Factor SSH Authentication with Authy - CentOS, Fedora</h1>

<p><strong>Difficulty:</strong> <em>1</em></p>
<p><strong>Time:</strong> <em>10 minutes</em></p>

<h2>Introduction</h2>
<p>Authy provides an easier platform for setting up an authentication as compared to two factor authentication. It is very simple to install and manage. In this article, you will learn how to configure a two-factor SSH Authentication with Authy. For this, you need to install an Authy application in your smartphone. You will get this in Google play. </p>


<h2>Configure Authy in phone</h2>
<ol>
<li>Download Authy from Google play and then configure Authy by getting it verified on your mobile number.</li>
<li>Build a developer account at https://dashboard.authy.com/signup.</li>

<p class="note">Make sure that you use the same mobile number which you have used in the Authy application. </p>

<li>Verify your account by completing the verification process sent to your registered email account. You will get a token on your mobile.</li>
</ol>
<h2>Create an application</h2>
<ol>
<li>Log in to your developer's account. </li>
<br/><img src="images/17506/091815/Enterprise-and-developers-dashboard.png" alt="Enterprise-and-developers-dashboard.png" />
<li>Enter the <strong>Application Name</strong> and click on the <strong>Create App</strong> button to create an application.</li>
<p><img src="images/17506/091815/welcome-to-the-Authy-Dashboard.png" alt="welcome-to-the-Authy-Dashboard.png" /></p>

<li>You will get an API key after you have created the application.</li>
 <p><img src="images/17506/091815/API-key.png" alt="API-key.png" /></p>
<p>Copy the API key  as it is. You will need this in further steps.</p>

</ol>

<h2>Configure server</h2>
<ol>
<li>Download the Authy installer.
<div class="hacker">curl "https://raw.githubusercontent.com/authy/authy-ssh/master/authy-ssh" -o authy-ssh</div></li>

<li>Install Authy.
<div class="hacker">sudo bash authy-ssh install /usr/local/bin</div></li>

<p>It will prompt you to enter the API key that you received from the Authy website. Choose option 1 when prompted for <strong>what to do when Authy is down</strong>.</p>
</ol>
<h2>Configure two-factor for the user </h2>
<ol>
<li>Run the following command to configure the user.
<div class="hacker">sudo /usr/local/bin/authy-ssh enable <em><u>User_name</u></em> <em><u>email_id</u></em> <em><u>country_code</u></em></div>
</li>

<li>Restart the SSH server.
<div class="hacker">sudo service sshd restart</div>
</li>

<li>Make sure that the command is located at <code>your/etc/ssh/sshd_config</code> file.
<div class="hacker">cat /etc/ssh/sshd_config | grep ForceCommand</div>
</li>

<li>If the command was not installed at <code>/etc/ssh/sshd_config</code> file, manually enter it and restart the SSH service again.
<div class="hacker">ForceCommand /usr/local/bin/authy-ssh login</div>
<div class="hacker">sudo service sshd restart</div>
</li>
<li>Uninstall <code>authy-ssh</code> using the following command:
<div class="hacker">sudo /usr/local/bin/authy-ssh uninstall</div>
</li>
</ol>

<h2>Next step</h2>
<p>In this article, you have learnt to configure two factor authentication in SSH server using Authy. To know more about configuring two factor authentication using Google Authenticator visit, <a href="17503"> Configure Two-factor SSH Authentication with PAM - CentOS, Fedora</a></p>
 </body>
</html>