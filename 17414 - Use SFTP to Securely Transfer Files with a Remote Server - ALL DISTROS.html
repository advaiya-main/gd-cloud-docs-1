<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<!--Use this template for articles that include steps for accomplishing a task or tasks (for example, installing). For articles that explain or describe something (such as an operating system), use the Informational template instead.  -->

<title>Use SFTP to Securely Transfer Files with a Remote Server - ALL DISTROS</title>
<style type="text/css">
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }

p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}

.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
</style>

</head>

<body>
            <p>Describes how to transfer files securely using SFTP.</p>


<h1>How To Use SFTP to Securely Transfer Files with a Remote Server</h1>

                    <p><strong>Difficulty</strong>: <em><u>1</u></em><br/>
                    <strong>Time</strong>: <em><u>1.50</u></em></p>

                <p>SFTP uses the SSH  protocol to authenticate and establish a secure connection.  It's recommended to  create SSH keys and transfer the public key to any system where access is needed.</p>

<h2>Prerequisite</h2>

            Use this article to <a href="17357 - Use SSH Keys with your Cloud Server (Linux and Mac OS X) - ALL DISTROS.html">set up SSH keys</a> in order to access your server if you have not done so already.
        <ol>


            <li>To test SSH access by running the following command:
                    <div class="hacker">ssh yourusername@remote_hostname_or_IP</div></li>

            <li>If that works, exit back out by running the following command:
                    <div class="hacker">exit </div></li>

        </ol>

<h2>How to Connect with SFTP</h2>


    <ol>


            <li>To set up an SSH connection and then open up an SFTP session; run the command:
                    <div class="hacker">sftp yourusername@remote_hostname_or_IP</div>
            You will connect the remote system and your prompt will change to an SFTP prompt.</li>

    </ol>


<h2>Getting Help in SFTP</h2>


    <ol>    <li>The <code>help</code> command a valuable tool for providing a list of the available commands for SFTP. To access <code>help</code> run one  of the following commands:
                    <div class="hacker">help</div>
                    <div class="hacker">?</div>



            Example Output:
                    <div class="hacker">
<pre>Available commands:
bye                                Quit sftp
cd path                            Change remote directory to 'path'
chgrp grp path                     Change group of file 'path' to 'grp'
chmod mode path                    Change permissions of file 'path' to 'mode'
chown own path                     Change owner of file 'path' to 'own'
df [-hi] [path]                    Display statistics for current directory or
                                   filesystem containing 'path'
exit                               Quit sftp
get [-Ppr] remote [local]          Download file
help                               Display this help text
lcd path                           Change local directory to 'path'</pre></div></li>


    </ol>


<h2>Exploring SFTP</h2>


    <ol>
            <li>To find the remote system's current directory, run the following command:
                    <div class="hacker">pwd</div>

            Example Output:
                    <div class="hacker">Remote working directory: /home/newuser</div>
                    <p class="note">Note: The filenames and home directories are examples used for this document.</p></li>


            <li>To view the contents of the current directory of the remote system run the following command:
                    <div class="hacker">ls</div>
            Example Output:

                    <div class="hacker">example.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; faq.html&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; docu.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exampleDirectory</div></li>

            <li>The commands within the SFTP interface are not as feature-rich. However, they do implement some of the more important optional flags to view these flags run the following command:
                    <div class="hacker">ls -la</div>
            Example Output:
                <div class="hacker">
<pre>drwxr-xr-x    5 newuser   newuser       4096 Aug 13 15:11 .
drwxr-xr-x    3 root     root         4096 Aug 13 15:02 ..
-rw-------    1 newuser   newuser          3 May 15 15:04 .bash_history
-rw-r--r--    1 newuser   newuser        175 May 15 15:02 .bash_logout
-rw-r--r--    1 newuser   newuser       1591 May 15 15:02 .bashrc
drwx------    2 newuser   newuser       2345 May 15 15:04 .cache
-rw-r--r--    1 newuser   newuser        874 May 15 15:02 .profile
. . .</pre></div></li>

            <li>To change to another directory, run the following command:
                    <div class="hacker">cd exampleDirectory</div></li>


            <li>Direct commands towards the local file system by preceding the command with an "l" for local. All of the commands discussed so far have local equivalents. To print the local working directory, run the following command:

                    <div class="hacker">lpwd</div>
                      Example Output:
                    <div class="hacker">Local working directory: /Users/newuser<br/>
                    . . .</div></li>



            <li>To list the contents of the current directory on the local machine run the following command:
                    <div class="hacker">lls</div>
                      Example Output:
                    <div class="hacker">
<pre>Desktop            local.txt       test.html
Documents       data.rtf       echo.html</pre>
                    . . .</div></li>

            <li>To change the directory to interact with on the local system run the following command:

                    <div class="hacker">lcd Desktop</div></li>
    </ol>


<h2>Transferring Files with SFTP</h2>
<h3>Transferring Remote Files to the Local System</h3>

    <ol>
                <li>To download files from the remote host, run the following command:
                    <div class="hacker">get remote File </div>
                    Example Output:
                    <div class="hacker">
<pre> Fetching /home/newuser/remoteFile to remoteFile
 /home/newuser/remoteFile                              100%    29KB    42.8KB/s    00:01</pre></div>
 By default, the <code>get</code> command download's a remote file to a file with the same name on the local file system </li>

                <li>Copy the remote file to a different name, specify the name afterwards:
                    <div class="hacker">get remoteFile localFile</div></li>

                <li>Specify the recursive option to copy a directory and all of its contents :
                    <div class="hacker">get -r someDirectory</div> </li>

                <li>To maintain the appropriate permissions and access times use the "-P" or "-p" flag:
                    <div class="hacker">get -Pr someDirectory</div></li>
    </ol>


<h3>Transferring Local Files to the Remote System</h3>

    <ol>
                <li>To transfer files to the remote system, use the  <code>put</code> command:
                    <div class="hacker">put localFile </div>
                    Example Output:
                    <div class="hacker">
<pre>Uploading localFile to /home/newuser/localFile
localFile                                     100% 7607     6.3KB/s   00:00</pre></div></li>


                <li>
                    <div class="hacker"> </div>
                    Example Output:
                    <div class="hacker"> </div></li>


                <li><code>put</code> utilizes the same flags as <code>put</code>. To copy an entire local directory, run the following command:
                        <div class="hacker">put -r localDirectory</div> </li>

                 <li> <code>df</code> command reports filesystem disk space usage. To verify available disk space for transfers, run the following command:
                        <div class="hacker">df -h </div>
                    Example Output:
                    <div class="hacker">
<pre>   Size       Used        Avail (root)        %Capacity
    19.9GB      1016MB      17.9GB 18.9GB           4%</pre> </div>
                        <p class="note">Please note, that there is no local variation of this command, but we can get around that by issuing the "!" command</p></li>

        <li> Use the "!" command  to drop into a local shell, to check disk usage run the following command:
                    <div class="hacker"> ! <br />
                                        df -h</div>
                    Example Output:
                    <div class="hacker">
<pre>  Filesystem     Size    Used    Avail   Capacity    Mounted on
 /dev/disk0s2   425Gi   82Gi    644Gi   9%      /
 devfs          155Ki   155Ki   0Bi     100%    /dev
 map -hosts     0Bi     0Bi     0Bi     100%    /net
 map auto_home  0Bi     0Bi     0Bi     100%    /home</pre></div> </li>


                <li>Any other local command will work as expected. To return to the SFTP session,run the following command:
                       <div class="hacker">exit</div>


                <p class="note">The SFTP prompt will return.</p> </li>


    </ol>

<h2>Conclusion</h2>

         <p>SFTP is a simple tool, that provides file access, file transfer, and file management functionalities over secure data stream. It leverages the strengths of FTP or SCP. And is a helpful tool </p>




</body>
</html>