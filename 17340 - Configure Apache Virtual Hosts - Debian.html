<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=windows-1250" />
    <meta name="generator" content="PSPad editor, www.pspad.com" />
         
   <h1>      Configure Apache Virtual Hosts – Debian</h1>
  
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:Editor0 msdt:dt="string">Carla</mso:Editor0>
<mso:KpiDescription msdt:dt="string">Please revise using comments in Arch Linux version as a guide. Thanks! -Carla</mso:KpiDescription>
<mso:Last_x0020_updated msdt:dt="string">2015-07-06T00:00:00Z</mso:Last_x0020_updated>
<mso:Author0 msdt:dt="string">Christine</mso:Author0>
<mso:Dependency msdt:dt="string"></mso:Dependency>
<mso:ArticleKeywords msdt:dt="string">Apache, Setup, Virtual Host</mso:ArticleKeywords>
<mso:Complexity msdt:dt="string">3 - Somewhat complex</mso:Complexity>
<mso:Reference msdt:dt="string">https://www.digitalocean.com/community/tutorials/how-to-set-up-apache-virtual-hosts-on-debian-7, https://www.digitalocean.com/community/tutorials/how-to-set-up-apache-virtual-hosts-on-debian-7</mso:Reference>
<mso:ArticleStatus msdt:dt="string">Rewriting in progress</mso:ArticleStatus>
<mso:HoursEditingEstimated msdt:dt="string">0.750000000000000</mso:HoursEditingEstimated>
<mso:Dependencies msdt:dt="string"></mso:Dependencies>
<mso:ArticlePriority msdt:dt="string">1</mso:ArticlePriority>
<mso:AssignedTo1 msdt:dt="string">27</mso:AssignedTo1>
<mso:HoursDraftingEstimated msdt:dt="string">3.00000000000000</mso:HoursDraftingEstimated>
<mso:RequestNotes msdt:dt="string">Prereq: - 'Initial Server Setup'' 'Build a LAMP stack.' FQDN pointed at server. Include simple instructions for installing Apache for those who do not want full LAMP.</mso:RequestNotes>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_AssignedTo1 msdt:dt="string">Christine Tzeng</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_AssignedTo1>
<mso:DeliveryTarget msdt:dt="string">Phase 2</mso:DeliveryTarget>
<mso:EditScore msdt:dt="string"></mso:EditScore>
<mso:Difficulty msdt:dt="string">2</mso:Difficulty>
<mso:ForkSplit msdt:dt="string"></mso:ForkSplit>
<mso:HoursDraftingActual msdt:dt="string">2.50000000000000</mso:HoursDraftingActual>
<mso:ArticleID msdt:dt="string">17340</mso:ArticleID>
<mso:UnsupportedFeatures msdt:dt="string"></mso:UnsupportedFeatures>
<mso:Collapsed0 msdt:dt="string"></mso:Collapsed0>
<mso:PercentResearch msdt:dt="string">0.250000000000000</mso:PercentResearch>
<mso:PercentWriting msdt:dt="string">0.750000000000000</mso:PercentWriting>
<mso:Week msdt:dt="string">10.0000000000000</mso:Week>
<mso:LinuxDistributions msdt:dt="string">;#Debian;#</mso:LinuxDistributions>
<mso:ReviewComments msdt:dt="string">Please revise using comments in Arch Linux version as a guide. Thanks! -Carla</mso:ReviewComments>
<mso:PrereqOrdering msdt:dt="string">2</mso:PrereqOrdering>
<mso:AssignmentAction msdt:dt="string"></mso:AssignmentAction>
<mso:TestComments msdt:dt="string"></mso:TestComments>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_ReviewedBy msdt:dt="string">Carla  Johnson</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_ReviewedBy>
<mso:ReviewedBy msdt:dt="string">41</mso:ReviewedBy>
</mso:CustomDocumentProperties>
</xml><![endif]-->
<title>Configure Apache Virtual Hosts - Debian</title></head>
  <body>       
    
    To run several domains off of one IP address, you’ll need to set up virtual hosts. This is helpful when you want to run multiple sites from a single server. Apache is the world’s most popular web server and can run a multitude of content based on IP address or hostname.<br />
    <br />
    This guide will walk you through how to set up two Apache virtual hosts on Debian.<br />
    <br />
    Remember: You need to first create a separate, non-root user and give that user sudo permissions. <!--***NOTE: LINK TO "Initial Server Setup – Debian" ARTICLE ONCE AVAILABLE -->  
    <p class="note">If you need the full LAMP stack (Linux, Apache, MySQL, and PHP), you would also need to install MySQL and PHP.</p>  
    <br />
    
    <h2>To Install Apache</h2>
    
     Install Apache if you haven't done so already: <br /> 
    <div class="hacker">sudo apt-get install apache2</div>         <br />
   
        
    <h2>To Create a Directory</h2>
    
    Create a directory that will hold the new website files.

This location will be your Document Root in the Apache virtual host configuration file. We will be referring to the Document Root later in the process. </ p>

    For this tutorial we will use example domain names <em><u>domain1.com</u></em> and <em><u>domain2.com</u></em><p />
    <div class="hacker">
    sudo mkdir -p /var/www/domain1.com/public_html<br />
    sudo mkdir -p /var/www/domain2.com/public_html<br /> </div>
   
   <p class="note">Adding <code>-p</code> to the code automatically generates all parent directories.<p />
   
   Make sure your hostname has a valid DNS record so that the www version of your domain works.
   
   <h2>To Give Access to the User</h2>
    
    <ol>
    <li>Grant ownership of your directories to the user with the <code>chown</code> command, otherwise only the root user will have permission.</li>
     
     <div class="hacker">
     sudo chown -R $USER:$USER /var/www/domain1.com/public_html  <br />
     sudo chown -R $USER:$USER /var/www/domain2.com/public_html  <p /> </div> </li>
     
     <li>Grant read access to your new files.
     <div class="hacker">
      sudo chmod -R 644 /var/www </div>   </li></ol>
     
   <h2>To Create Sample Pages for each Virtual Host</h2>
    <ol>
    <li>Create a sample page for your first virtual host<br />
    Make some sample content for your newly-created directory structure.<br />
    For simplicity’s sake, let’s create index.html pages.<br />
    <div class="hacker"> 
    sudo vim /var/www/domain1.com/public_html/index.html</div>
    Add the following contents:<br />
    <div class="hacker"> 
    &lt;html&gt;<br />
    &lt;head&gt;<br />
    &lt;title&gt;Welcome to domain1.com!&lt;/title&gt;<br />
    &lt;/head&gt;<br />
    &lt;body&gt;<br />
    &lt;h1&gt;Success! The domain1.com virtual host is working!&lt;/h1&gt;<br />
    &lt;/body&gt;<br />
    &lt;/html&gt;<br />     </div>
    Save and close the file.</li>
    
    <li>Create a sample page for your second virtual host<br />
        <div class="hacker"> 
    sudo vim /var/www/domain2.com/public_html/index.html</div></div>
    
   Update the information in the page contents for your second page.
    
    &lt;html&gt;<br />
    &lt;head&gt;<br />
    &lt;title&gt;Welcome to domain2.com!&lt;/title&gt;<br />
    &lt;/head&gt;<br />
    &lt;body&gt;<br />
    &lt;h1&gt;Success! The domain2.com virtual host is working!&lt;/h1&gt;<br />
    &lt;/body&gt;<br />
    &lt;/html&gt;<br /></div>
    Save and close.
    </li>
    </ol>
    
<h2>To Configure your Virtual Hosts</h2>
    
   Enable the virtual hosts on the server.  <br />
      <ol>
      <li> Open the Apache configuration: <br />
<div class="hacker">
sudo cp /etc/apache2/sites-available/default /etc/apache2/sites-available/domain1.com.conf</div></li>

<li>Get your virtual host file from the Apache folder:  <br />
<div class="hacker">sudo vim /etc/apache2/sites-available/domain1.com</div> </li>
                                        
<li>Create a virtual host in this file. <br />

Insert a line for the <code>ServerName</code> under the <code>ServerAdmin</code> line. <br /> 
                                                                          
<div class="hacker">ServerName example.com </div> </li>

<li> 	Continue to configure your virtual host. Include alternate names, such as the www, in your virtual host file by adding a <code>ServerAlias</code> line. Then, enter your file location for <code>DocumentRoot</code>. This field must not be absent.<br />
<div class="hacker">
&lt;VirtualHost *:80&gt;<br>
<br>
    ServerAdmin webmaster@domain1.com<br />
    ServerName domain1.com<br />
    ServerAlias www.domain1.com<br />
    DocumentRoot /var/www/domain1.com/public_html<br />
    ErrorLog ${APACHE_LOG_DIR}/domain1.com.error.log   <br />
    CustomLog ${APACHE_LOG_DIR}/domain1.com.access.log <br />     </ div>
    
    <p class="warning">Make sure your document root is correct. You will not able to set up your virtual host without it.</br>        
    Save and close. <br />
    </li>

<li>  Activate your host with this built-in apache shortcut:         
  <div class="hacker">sudo a2ensite domain1.com.conf   </div> </li></ol>
    
Repeat these steps for additional domains.
                    
   
 <h2>To Restart Apache</h2>
 Restart Apache for the changes to activate. <br />
 <div class="hacker">sudo service apache2 restart</div>
 
 <h2>To Add the Domain Names to Hosts File</h2>
If you are not yet connected to an actual domain name, you can map your domain to your local IP for checking purposes. <br />
 <div class="hacker">vim /etc/hosts</div> 

<h2>To Test your Setup</h2>
Type if your IP address into your browser. You should see a page with a single line of text:<br>
&lt;h1&gt;Success! The domain1.com virtual host is working!&lt;h1&gt;<br />

<!--CT: added! 7/27--> 

<p class="note">You can test your virtual host locally by setting up local hosts on your computer alone. This is a good option if you have not yet pointed your domain name to the IP address of your VPS. See <a href="https://blueprintcs.sharepoint.com/sites/gdcmp/Articles/00003 - Set up Local Hosts to Test Virtual Host Setup – ALL DISTROS.html"> Set up Local Hosts to Test Virtual Host Setup – ALL DISTROS</a> for more on how to do this.</p> 

<!--future article part end-->
             
   <h2>Next Steps</h2>
    You can add additional virtual hosts as there's no software limit on the number of domain names Apache can handle. Be sure to set up a new document root with your domain name for each new host.<p />
        
  </body>
</html>